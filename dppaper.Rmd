---
title: "gdpR: An R Package for studying differentially private algorithms"
date: "2023-11-01"
abstract: >
    This paper serves as a reference and introduction on using the $gdpR$ R
    package. The goal of this package is to provide some tools for exploring the
    impact of different privacy regimes on a Bayesian analysis. A strength of
    this framework is the ability to target the exact posterior in settings
    where the likelihood is too complex to analytically express.
draft: true
author:  
  - name: Jordan A. Awan
    affiliation: Purdue University
    address:
    - Department of Statistics
    - West Lafayette, IN 47907
    url: https://www.britannica.com/animal/quokka
    email: jawan@purdue.edu
  - name: Kevin Eng
    affiliation: Rutgers University
    address:
    - Department of Statistics
    - Piscataway, NJ 08854
    url: https://www.britannica.com/animal/quokka
    email: ke157@stat.rutgers.edu
  - name: Robin Gong
    affiliation: Rutgers University
    address:
    - Department of Statistics
    - Piscataway, NJ 08854
    url: https://www.britannica.com/animal/quokka
    email: ruobin.gong@rutgers.edu
  - name: Nianqiao Phyllis Ju
    affiliation: Purdue University
    address:
    - Department of Statistics
    - West Lafayette, IN 47907
    url: https://www.britannica.com/animal/quokka
    email: nianqiao@purdue.edu
  - name: Vinayak A. Rao
    affiliation: Purdue University
    address:
    - Department of Statistics
    - West Lafayette, IN 47907
    url: https://www.britannica.com/animal/quokka
    email: varao@purdue.edu
type: package
output: 
  rjtools::rjournal_article:
    self_contained: yes
    toc: no
bibliography: RJreferences.bib

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(plotly)
library(ggplot2)
library(palmerpenguins)
library(kableExtra)
```



# Introduction


The ease and pervasiveness of modern data collection technologies has raised
concerns about data privacy. [@Dwork2013] introduced the differential privacy
framework as a means to rigorously define privacy. The framework has lead to the
development of many ``privitized'' versions of existing statistical methods. The
process of privitizing usually consist of introducing random noise in someway using
a known distribution.


# Using \CRANpkg{gdpR}

## Sampling

The main function in \pkg{gplsim} is the `gdp_sample` function. The call
signature of the function is:

```{r, echo = TRUE, eval = FALSE}
gdp_sample(data_model, sdp, nobs, init_par, niter = 2000, warmup = floor(niter / 2),
           chains = 1, varnames = NULL)
```

The three required inputs into `gdp_sample` function are the privacy model (`data_model`), the value
of the  observed privatized statistic (`sdp`), and the total number of observations 
in the complete data (`nobs`) [MAKE SURE NOTATION IS INTRODUCED]. The \CRANpkg{gdpR}
package is best suited for problems where the complete data can be represented in
tabular form. This is because internally, it is represented as a matrix.

The optional arguments are the number of mcmc draws (`niter`), the 
burn in period (`warmup`), number of chains (`chains`) and character
vector that names the parameters. Running multiple chains can be done in parallel
using the \CRANpkg{furrr} package. Additionally, progress can be monitored
using the \CRANpkg{progressr} package.


The `data_model` input is a `privacy`
object that can be constructed using the `new_privacy` constructor. The
process of constructing a `privacy` object will be discussed in the next section.

## Privacy Model

Creating a privacy model is done using the `new_privacy` constructor. The 
main arguments consist of the four components as outlined in the methodology
section.

```{r, echo=TRUE, eval=FALSE}
new_privacy(post_smpl = NULL, lik_smpl = NULL, ll_priv_mech = NULL,
            st_calc = NULL, add = FALSE, npar = NULL)
```

The internal implementation of the DA algorithm in `gdp_sample` requires
some care in how each component in constructed. 

* `lik_smpl` is an R function that samples from the likelihood. Its
call signature should be `lik_smpl(theta)` where `theta` is a vector
representing the likelihood model parameters being estimated. This function
must work with the supplied initial parameter provide in the `init_par`
argument of `gdp_sample`. The sampler need not be vectorized and vectorizing
the sampler will not add any speed benefits.


* `post_smpl` is a function which represents the posterior sampler. It should
have the call signature `post_smpl(dmat, theta)`. Where `dmat` is the 
complete data. This sampler can be generated by wrapping mcmc samplers generated from other R packages 
(e.g. \CRANpkg{rstan}, \CRANpkg{fmcmc}, \CRANpkg{adaptMCMC}).
If using this approach, it is recommended to avoid using packages such as \CRANpkg{mcmc}
whose implementation clashes with `gdp_sample`. In the case of \CRANpkg{mcmc},
the Metropolis-Hastings loop is implemented in C which incurs a very large overhead
in `gdp_sample` since it is reinitialized every iteration. In general, repeatedly calling
an R function that hooks into C code is slow. (NOT QUITE ACCURATE FIX LATER)



# Example

# Background

Some packages on interactive graphics include \CRANpkg{plotly} [@plotly] that interfaces with Javascript for web-based interactive graphics, \CRANpkg{crosstalk} [@crosstalk] that specializes cross-linking elements across individual graphics.  The recent R Journal paper \CRANpkg{tsibbletalk} [@RJ-2021-050] provides a good example of including interactive graphics into an article for the journal. It has both a set of linked plots, and also an animated gif example, illustrating linking between time series plots and feature summaries.

# Customizing tooltip design with \pkg{ToOoOlTiPs}


# Summary

We have displayed various tooltips that are available in the package \pkg{ToOoOlTiPs}. 
